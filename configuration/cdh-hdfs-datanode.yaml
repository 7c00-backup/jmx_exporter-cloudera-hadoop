---
startDelaySeconds: 0
ssl: false
lowercaseOutputName: true
lowercaseOutputLabelNames: true
attrNameSnakeCase: true
whitelistObjectNames:
  - 'Hadoop:service=DataNode,name=*'
blacklistObjectNames:
  - 'Hadoop:service=DataNode,name=RpcActivity*'
  - 'Hadoop:service=DataNode,name=RpcDetailedActivity*'
  - 'Hadoop:service=DataNode,name=UgiMetrics*'
rules:
  # DataNodeActivity pattern
  - pattern: 'Hadoop<service=(.*), name=DataNodeActivity-(.*)-(\d+)><>(.*): (\d+)'
    name: hadoop_$1_$4
    value: $5
    labels:
      service: HDFS
      role: $1
      host: $2
      port: $3
      kind: 'DataNodeActivity'
    type: GAUGE
  # DataNodeInfo pattern
  - pattern: 'Hadoop<service=(.*), name=DataNodeInfo><>(.*): (\d+)'
    name: hadoop_$1_$2
    value: $3
    labels:
      service: HDFS
      role: $1
      kind: 'DataNodeInfo'
    type: GAUGE
  # FSDatasetState pattern (also extracts the FSDataset ID)
  - pattern: 'Hadoop<service=(.*), name=FSDatasetState-(.*)><>(.*): (\d+)'
    name: hadoop_$1_$3
    value: $4
    labels:
      service: HDFS
      role: $1
      fsdatasetid: $2
      kind: 'FSDatasetState'
    type: GAUGE
  # JVM Metrics
  - pattern: 'Hadoop<service=(.*), name=JvmMetrics><>(.*): (\d+)'
    name: hadoop_$1_$2
    value: $3
    labels:
      service: HDFS
      role: $1
      kind: 'JVMMetrics'
    type: GAUGE
  # Wildcard pattern to match new and unknown/unconfigured metrics
  - pattern: 'Hadoop<service=(.*), name=(.*)><>(.*): (\d+)'
    name: hadoop_$1_$3
    value: $4
    labels:
      service: HDFS
      role: $1
      kind: $2
      unknown: '1'
    type: GAUGE
